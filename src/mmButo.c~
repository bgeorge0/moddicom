#include <R.h>
#include <Rinternals.h>
#include <math.h>

void nOrderMoment(double *matrix, int *Nx, int *Ny, int *Nz,double *order,double *mX,double *mY,double *mZ ) {

	mX=0;	mY=0;	mZ=0;
	int x,y,z;
	int numberOfPoints=0;

	for(z=0; z<(*Nz); z++) {
		for(y=0; z<(*Ny); y++) {
			for(x=0; x<(*Nz); x++) {		
				if ( matrix[x + (y * (*Nx)) +  z * ( x + y )] !=0)   {
					*mX += pow(x, *order );
					*mY += pow(y, *order );
					*mZ += pow(z, *order );
					numberOfPoints++;
				}
			}
		}
	}
	*mX = *mX/numberOfPoints;
	*mY = *mY/numberOfPoints;
	*mZ = *mZ/numberOfPoints;
}




